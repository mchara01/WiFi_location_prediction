(init.py:845128): Gdk-CRITICAL **: 10:37:26.792: gdk_cursor_new_for_display: assertion 'GDK_IS_DISPLAY (display)' failed
Building Clean Decision Tree
Step 2 (Bonus) - Plotting Decision Tree
Step 3 - Evaluation
Evaluating clean dataset...
Confusion Matrix of all folds
[array([[54,  0,  1,  0],
       [ 0, 49,  5,  0],
       [ 0,  1, 41,  1],
       [ 0,  0,  0, 48]]), array([[42,  0,  0,  0],
       [ 0, 51,  1,  0],
       [ 0,  1, 51,  1],
       [ 1,  0,  0, 52]]), array([[63,  0,  0,  0],
       [ 0, 51,  0,  0],
       [ 0,  3, 53,  0],
       [ 0,  0,  1, 29]]), array([[47,  0,  0,  0],
       [ 0, 44,  2,  0],
       [ 0,  1, 46,  0],
       [ 1,  0,  0, 59]]), array([[53,  0,  1,  2],
       [ 0, 47,  1,  0],
       [ 0,  3, 42,  0],
       [ 0,  0,  0, 51]]), array([[47,  0,  0,  0],
       [ 0, 45,  4,  0],
       [ 0,  1, 49,  0],
       [ 2,  0,  0, 52]]), array([[51,  0,  0,  0],
       [ 0, 47,  0,  0],
       [ 0,  1, 43,  0],
       [ 0,  0,  0, 58]]), array([[48,  0,  0,  0],
       [ 0, 49,  3,  0],
       [ 0,  4, 44,  0],
       [ 0,  0,  0, 52]]), array([[46,  0,  0,  0],
       [ 0, 46,  3,  0],
       [ 0,  5, 49,  0],
       [ 0,  0,  0, 51]]), array([[45,  0,  0,  0],
       [ 0, 52,  0,  0],
       [ 0,  3, 56,  1],
       [ 0,  0,  1, 42]])]
Average confusion matrix
[[49.6  0.   0.2  0.2]
 [ 0.  48.1  1.9  0. ]
 [ 0.   2.3 47.4  0.3]
 [ 0.4  0.   0.2 49.4]]
Accuracy on clean dataset: 0.9725
Recall on clean dataset: (array([0.992, 0.962, 0.948, 0.988]), 0.9725)
Precision on clean dataset: (array([0.992     , 0.95436508, 0.95372233, 0.98997996]), 0.9725168433222358)
F1-Score on clean dataset: (array([0.992     , 0.95816733, 0.95085256, 0.98898899]), 0.9725022193348247)
Average tree depth on clean dataset: 12.3

Evaluating noisy dataset...
Confusion Matrix of all folds
[array([[35,  5,  4,  1],
       [ 1, 40,  5,  1],
       [ 6,  3, 32,  8],
       [ 5,  1,  2, 51]]), array([[40,  2,  5,  6],
       [ 3, 35,  5,  1],
       [ 0,  6, 45,  2],
       [ 6,  4,  4, 36]]), array([[45,  7,  3,  5],
       [ 0, 44,  4,  4],
       [ 2,  2, 42,  2],
       [ 4,  2,  3, 31]]), array([[38,  2,  4,  3],
       [ 6, 38,  4,  1],
       [ 4,  6, 45,  7],
       [ 5,  2,  3, 32]]), array([[35,  0,  1,  6],
       [ 1, 45,  1,  2],
       [ 2,  1, 48,  6],
       [ 4,  3,  3, 42]]), array([[41,  2,  2,  2],
       [ 4, 44,  3,  3],
       [ 5,  3, 34,  2],
       [ 6,  3,  3, 43]]), array([[39,  4,  1,  3],
       [ 1, 41,  5,  5],
       [ 3,  2, 40,  3],
       [ 1,  4,  4, 44]]), array([[38,  5,  3,  4],
       [ 4, 40,  7,  2],
       [ 2,  3, 37,  4],
       [ 7,  2,  4, 38]]), array([[40,  3,  4,  4],
       [ 5, 33,  6,  2],
       [ 3,  6, 42,  4],
       [ 7,  1,  3, 37]]), array([[31,  5,  4,  8],
       [ 4, 39,  5,  3],
       [ 0,  5, 45,  3],
       [10,  2,  5, 31]])]
Average confusion matrix
[[38.2  3.5  3.1  4.2]
 [ 2.9 39.9  4.5  2.4]
 [ 2.7  3.7 41.   4.1]
 [ 5.5  2.4  3.4 38.5]]
Accuracy on noisy dataset: 0.7879999999999999
Recall on noisy dataset: (array([0.77959184, 0.8028169 , 0.7961165 , 0.77309237]), 0.7879044031188562)
Precision on noisy dataset: (array([0.77484787, 0.80606061, 0.78846154, 0.78252033]), 0.7879725849769881)
F1-Score on noisy dataset: (array([0.77721261, 0.80443548, 0.79227053, 0.77777778]), 0.7879241018738216)
Average tree depth on noisy dataset: 19.6

Step 4: Pruning (and Evaluation)
Pruning clean dataset...
Confusion Matrix of all folds
[array([[51,  0,  0,  0],
       [ 0, 43,  3,  0],
       [ 0,  1, 55,  2],
       [ 0,  0,  0, 45]]), array([[46,  0,  0,  0],
       [ 0, 49,  2,  0],
       [ 2,  5, 43,  0],
       [ 0,  0,  0, 53]]), array([[53,  0,  1,  1],
       [ 0, 49,  0,  0],
       [ 0,  3, 48,  0],
       [ 0,  0,  0, 45]]), array([[50,  0,  0,  0],
       [ 0, 55,  5,  0],
       [ 1,  0, 34,  0],
       [ 1,  0,  0, 54]]), array([[45,  0,  1,  0],
       [ 0, 48,  1,  0],
       [ 0,  0, 46,  0],
       [ 0,  0,  0, 59]]), array([[55,  0,  0,  0],
       [ 0, 31,  4,  0],
       [ 0,  1, 55,  0],
       [ 0,  0,  0, 54]]), array([[43,  0,  1,  0],
       [ 0, 43,  2,  0],
       [ 0,  4, 50,  0],
       [ 0,  0,  0, 57]]), array([[54,  0,  0,  0],
       [ 0, 51,  3,  0],
       [ 0,  0, 50,  0],
       [ 2,  0,  0, 40]]), array([[48,  0,  1,  0],
       [ 0, 51,  1,  0],
       [ 0,  0, 54,  0],
       [ 0,  0,  0, 45]]), array([[49,  0,  0,  1],
       [ 0, 55,  4,  0],
       [ 0,  5, 41,  0],
       [ 1,  0,  0, 44]])]
Average confusion matrix
[[49.4  0.   0.4  0.2]
 [ 0.  47.5  2.5  0. ]
 [ 0.3  1.9 47.6  0.2]
 [ 0.4  0.   0.  49.6]]
Accuracy on clean dataset: 0.9704999999999999
Recall on clean dataset: (array([0.988, 0.95 , 0.952, 0.992]), 0.9704999999999999)
Precision on clean dataset: (array([0.98602794, 0.96153846, 0.94257426, 0.992     ]), 0.9705351657689951)
F1-Score on clean dataset: (array([0.98701299, 0.95573441, 0.94726368, 0.992     ]), 0.9705027687609147)
Average tree depth on noisy dataset: 12.0

Pruning noisy dataset...
Confusion Matrix of all folds
[array([[32,  2,  2,  4],
       [ 3, 42,  2,  0],
       [ 2,  2, 48,  0],
       [ 3,  5, 11, 42]]), array([[31,  2,  5,  4],
       [ 3, 40,  7,  6],
       [ 4,  4, 42,  1],
       [ 2,  2,  7, 40]]), array([[30,  6,  5,  3],
       [ 1, 43,  0,  2],
       [ 2,  5, 39,  7],
       [ 4,  4,  5, 44]]), array([[41,  2,  3,  3],
       [ 4, 44,  4,  5],
       [ 1,  3, 45,  1],
       [ 7,  3,  5, 29]]), array([[38,  3,  1,  5],
       [ 4, 47,  4,  0],
       [ 4,  3, 48,  1],
       [ 5,  3,  2, 32]]), array([[28,  4,  3,  3],
       [ 4, 30,  5,  8],
       [ 3,  3, 49,  3],
       [ 3,  4,  2, 48]]), array([[51,  2,  4,  2],
       [ 2, 43,  2,  1],
       [ 0,  4, 47,  1],
       [ 2,  3,  1, 35]]), array([[39,  4,  1, 11],
       [ 4, 45,  1,  0],
       [ 6,  5, 34,  4],
       [ 3,  3,  7, 33]]), array([[42,  5,  3,  2],
       [ 1, 38,  1,  2],
       [ 3,  4, 46,  3],
       [ 1,  2,  3, 44]]), array([[48,  4,  3,  9],
       [ 3, 41,  3,  2],
       [ 1,  4, 32,  1],
       [ 4,  2,  0, 43]])]
Average confusion matrix
[[38.   3.4  3.   4.6]
 [ 2.9 41.3  2.9  2.6]
 [ 2.6  3.7 43.   2.2]
 [ 3.4  3.1  4.3 39. ]]
Accuracy on noisy dataset: 0.8065000000000001
Recall on noisy dataset: (array([0.7755102 , 0.83098592, 0.83495146, 0.78313253]), 0.8061450265014379)
Precision on noisy dataset: (array([0.81023454, 0.80194175, 0.80827068, 0.80578512]), 0.806558022452328)
F1-Score on noisy dataset: (array([0.79249218, 0.81620553, 0.82139446, 0.79429735]), 0.8060973814138579)
Average tree depth on noisy dataset: 18.9
