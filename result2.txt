Step 2 (Bonus) - Plotting Decision Tree
Building Clean Decision Tree...
Step 3 - Evaluation
Evaluating clean dataset...
Confusion Matrix of all folds on clean dataset:
[array([[56,  0,  0,  1],
       [ 0, 39,  3,  0],
       [ 0,  2, 53,  0],
       [ 0,  0,  0, 46]]), array([[52,  0,  1,  0],
       [ 0, 55,  1,  0],
       [ 0,  1, 48,  0],
       [ 0,  0,  0, 42]]), array([[45,  0,  0,  0],
       [ 0, 46,  5,  0],
       [ 0,  2, 50,  1],
       [ 1,  0,  0, 50]]), array([[49,  0,  0,  1],
       [ 0, 52,  3,  0],
       [ 0,  2, 48,  0],
       [ 0,  0,  0, 45]]), array([[50,  0,  0,  0],
       [ 0, 41,  1,  0],
       [ 0,  4, 46,  0],
       [ 2,  0,  2, 54]]), array([[47,  0,  1,  0],
       [ 0, 41,  2,  0],
       [ 1,  1, 52,  0],
       [ 0,  0,  0, 55]]), array([[55,  0,  0,  0],
       [ 0, 50,  3,  0],
       [ 0,  1, 46,  0],
       [ 0,  0,  1, 44]]), array([[42,  0,  0,  0],
       [ 0, 44,  1,  0],
       [ 1,  1, 50,  0],
       [ 1,  0,  0, 60]]), array([[49,  0,  0,  0],
       [ 0, 55,  0,  0],
       [ 0,  2, 43,  0],
       [ 0,  0,  0, 51]]), array([[51,  0,  0,  0],
       [ 0, 58,  0,  0],
       [ 0,  2, 43,  0],
       [ 0,  0,  0, 46]])]
Average confusion matrix: 
[[49.6  0.   0.2  0.2]
 [ 0.  48.1  1.9  0. ]
 [ 0.2  1.8 47.9  0.1]
 [ 0.4  0.   0.3 49.3]]
Accuracy on clean dataset:  0.9744999999999999
Recall on clean dataset:  (array([0.992, 0.962, 0.958, 0.986]), 0.9744999999999999)
Precision on clean dataset:  (array([0.98804781, 0.96392786, 0.95228628, 0.99395161]), 0.974553389921438)
F1-Score on clean dataset:  (array([0.99001996, 0.96296296, 0.9551346 , 0.98995984]), 0.9745193396528997)
Average tree depth on clean dataset:  12.5

Evaluating noisy dataset...
Confusion Matrix of all folds on noisy dataset:
[array([[43,  3,  2,  8],
       [ 1, 40,  4,  2],
       [ 1,  5, 38,  3],
       [ 3,  1,  3, 43]]), array([[49,  5,  1,  4],
       [ 2, 32,  5,  0],
       [ 4,  6, 40,  1],
       [ 6,  4,  1, 40]]), array([[32,  2,  4,  7],
       [ 7, 35,  2,  7],
       [ 6,  3, 43,  4],
       [ 3,  1,  2, 42]]), array([[35,  4,  4,  6],
       [ 4, 33,  5,  2],
       [ 3,  1, 45,  5],
       [10,  3,  3, 37]]), array([[36,  3,  1,  7],
       [ 1, 45,  3,  3],
       [ 1,  1, 47,  2],
       [ 2,  1,  7, 40]]), array([[33,  4,  3,  3],
       [ 7, 45,  5,  2],
       [ 3,  7, 36,  2],
       [ 1,  3,  6, 40]]), array([[41,  2,  1,  3],
       [ 2, 44,  6,  0],
       [ 3,  5, 41,  4],
       [ 1,  4,  4, 39]]), array([[35,  0,  7,  7],
       [ 2, 46,  3,  3],
       [ 7,  1, 41,  6],
       [ 2,  1,  3, 36]]), array([[41,  3,  3,  4],
       [ 1, 39,  6,  0],
       [ 2,  7, 36,  3],
       [ 5,  3,  4, 43]]), array([[31,  4,  3,  6],
       [ 0, 39,  8,  6],
       [ 6,  1, 43,  2],
       [ 4,  4,  4, 39]])]
Average confusion matrix:
[[37.6  3.   2.9  5.5]
 [ 2.7 39.8  4.7  2.5]
 [ 3.6  3.7 41.   3.2]
 [ 3.7  2.5  3.7 39.9]]
Accuracy on noisy dataset:  0.7915000000000001
Recall on noisy dataset:  (array([0.76734694, 0.80080483, 0.7961165 , 0.80120482]), 0.7913682729702076)
Precision on noisy dataset:  (array([0.78991597, 0.8122449 , 0.78393881, 0.78082192]), 0.7917303991713764)
F1-Score on noisy dataset:  (array([0.77846791, 0.8064843 , 0.78998073, 0.79088206]), 0.7914537495932327)
Average tree depth on noisy dataset:  18.7

Step 4: Pruning (and Evaluation)
Pruning clean dataset...
Confusion Matrix of all folds
[array([[56,  0,  1,  1],
       [ 0, 49,  3,  0],
       [ 0,  1, 47,  1],
       [ 0,  0,  0, 41]]), array([[43,  0,  0,  0],
       [ 0, 54,  4,  0],
       [ 2,  0, 50,  0],
       [ 0,  0,  0, 47]]), array([[56,  0,  1,  1],
       [ 0, 38,  3,  0],
       [ 0,  2, 43,  0],
       [ 2,  0,  0, 54]]), array([[51,  0,  0,  3],
       [ 0, 39,  5,  0],
       [ 1,  0, 44,  0],
       [ 0,  0,  0, 57]]), array([[39,  0,  0,  0],
       [ 0, 57,  6,  0],
       [ 0,  0, 41,  0],
       [ 1,  0,  1, 55]]), array([[52,  0,  0,  2],
       [ 0, 47,  1,  0],
       [ 0,  5, 48,  1],
       [ 0,  0,  0, 44]]), array([[55,  0,  0,  0],
       [ 0, 44,  3,  0],
       [ 0,  0, 54,  0],
       [ 1,  0,  0, 43]]), array([[49,  0,  0,  1],
       [ 0, 45,  2,  0],
       [ 0,  1, 50,  1],
       [ 0,  0,  0, 51]]), array([[50,  0,  0,  0],
       [ 0, 45,  1,  0],
       [ 0,  1, 49,  0],
       [ 0,  0,  0, 54]]), array([[38,  0,  0,  1],
       [ 0, 52,  2,  0],
       [ 0,  1, 57,  0],
       [ 0,  0,  0, 49]])]
Average confusion matrix
[[48.9  0.   0.2  0.9]
 [ 0.  47.   3.   0. ]
 [ 0.3  1.1 48.3  0.3]
 [ 0.4  0.   0.1 49.5]]
Accuracy on clean dataset: 0.9684999999999999
Recall on clean dataset: (array([0.978, 0.94 , 0.966, 0.99 ]), 0.9684999999999999)
Precision on clean dataset: (array([0.9858871 , 0.97713098, 0.93604651, 0.97633136]), 0.9688489866199558)
F1-Score on clean dataset: (array([0.98192771, 0.95820591, 0.9507874 , 0.98311817]), 0.968509799385749)
Average tree depth on clean dataset: 12.3

Pruning noisy dataset...
Confusion Matrix of all folds
[array([[35, 10,  5,  6],
       [ 1, 42,  6,  3],
       [ 3,  2, 42,  8],
       [ 4,  2,  1, 30]]), array([[38,  4,  5,  5],
       [ 3, 39,  3,  2],
       [ 3,  3, 40,  3],
       [ 1,  2,  4, 45]]), array([[35,  2,  3,  6],
       [ 1, 45,  2,  4],
       [ 6,  3, 40,  5],
       [ 4,  2,  1, 41]]), array([[42,  7,  3,  7],
       [ 1, 37,  6,  2],
       [ 2,  4, 32,  5],
       [ 2,  0,  2, 48]]), array([[34,  2,  8,  3],
       [ 1, 43, 10,  2],
       [ 0,  2, 45,  4],
       [ 1,  1,  5, 39]]), array([[33,  0,  4,  3],
       [ 1, 40,  5,  8],
       [ 1,  4, 45,  4],
       [ 6,  4,  1, 41]]), array([[32,  4,  4,  3],
       [ 2, 42,  7,  4],
       [ 1,  0, 45,  4],
       [ 2,  2,  2, 46]]), array([[40,  6,  4,  5],
       [ 2, 31,  6,  4],
       [ 5,  3, 40,  4],
       [ 1,  2,  1, 46]]), array([[41,  1,  3,  5],
       [ 3, 33,  6,  4],
       [ 2,  1, 45,  6],
       [ 1,  2,  4, 43]]), array([[33,  3,  2,  4],
       [ 2, 35,  3,  6],
       [ 0,  6, 44,  3],
       [ 1,  2,  4, 52]])]
Average confusion matrix
[[36.3  3.9  4.1  4.7]
 [ 1.7 38.7  5.4  3.9]
 [ 2.3  2.8 41.8  4.6]
 [ 2.3  1.9  2.5 43.1]]
Accuracy on noisy dataset: 0.7995
Recall on noisy dataset: (array([0.74081633, 0.77867203, 0.81165049, 0.86546185]), 0.7991501728875556)
Precision on noisy dataset: (array([0.85211268, 0.81818182, 0.77695167, 0.76554174]), 0.8031969769438914)
F1-Score on noisy dataset: (array([0.79257642, 0.79793814, 0.79392213, 0.81244109]), 0.7992194460268828)
Average tree depth on noisy dataset: 18.0
